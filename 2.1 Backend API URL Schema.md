# ðŸŽ® Backend API URL Schema:

This document provides a comprehensive overview of the Poker Backend API, including available endpoints, request/response formats, and usage examples.

ðŸ’¡The API enforces various validation rules to ensure data integrity. If validation fails, the API will return a `400 Bad Request` error with details about the failed validation.

# ðŸ“ Notes

### âŒ› Endpoints Status
Endpoints are marked for their status
- âœ³ï¸ fully implemented and should just work
- âœ´ï¸ development in progress
- â›” not yet implemented but planned

### ðŸ”— Base URL
Base url for staging server:
```
https://staging-pokerebot-backend.onrender.com
```

Base url for production server:
```
https://pokerebot-backend-django.onrender.com
```

# ðŸ“¡ API Endpoints

## ðŸ“Œ Verify and Authentication API

### âœ³ï¸ Verify and Authenticate a Telegram User

Validates a Telegram user's `initData`, confirms their identity, and updates their last login timestamp.

**Endpoint:**
```
POST {{baseUrl}}/players/verify/
```

**Input Parameters:**
| Parameter | Location | Type | Required | Description |
| --- | --- | --- | --- | --- |
| `initData` | Headers | string | Yes | URL-encoded authentication data from Telegram ([docs](https://core.telegram.org/bots/webapps#validating-data-received-via-the-mini-app)) |

**Response Status Codes:**
- `200 OK`: User verified successfully
- `201 Created`: User not exists but created successfully
- `400 Bad Request`: Missing initData, Missing auth_date, Missing user ID in initData
- `401 Unauthorized`: Authentication failed, initData has expired

**Response Body:**
| Field | Type | Description |
| --- | --- | --- |
| `error` | String | Error message when request fails |
| `exists` | Boolean | Whether user exists in database (on success) |
| `created` | Boolean | Whether user was created (on 201 status) |

**Example Usage:**
```
POST {{baseUrl}}/players/verify/
```

```
// Request Headers
| Header     |Value                                                                                                                                                                                                                                                                                                    |
|------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `initData` | `user=%7B%22id%2...` |
```

```
// Request Body
N/A
```

```
// Response (200 OK)
{
    "exists": true
}
```

```
// Response (201 Created)
{
  "message": "Player joined the Game successfully"
}
```

## ðŸ“Œ Player

### âœ³ï¸ Player Profile API

**`GET`  | Get Current Player Details:** Retrieve the current authenticated Telegram player's details
**`PUT`  | Update Current Player Details:** Update specific fields for the authenticated player

**Get Current Player Details**

- Requires `initData` from Telegram Mini App. Must be included in **request headers** as `"initData"`.
- Authentication handled via `@require_telegram_self` decorator.

**Endpoint:**
```
GET {{baseUrl}}/players/me/
```

**Input Parameters (In Headers):**
| Parameter  | Location | Type   | Required | Description                                                                                                                          |
|------------|----------|--------|----------|--------------------------------------------------------------------------------------------------------------------------------------|
| `initData` | Headers  | string | Yes      | URL-encoded authentication data from Telegram ([docs](https://core.telegram.org/bots/webapps#validating-data-received-via-the-mini-app)). Must be validated server-side. |

**Response Status Codes:**
- `200 OK`: Player details return successfully
- `404 NOT FOUND`: Player not found

**Response Body:**
| Field | Type | Description |
| --- | --- | --- |
| `telegram_id` | Integer | Telegram user ID |
| `first_name` | String | Player's first name |
| `last_name` | String | Player's last name |
| `roles` | List | Player roles (`player`, `host`, etc.) |
| `balance` | Integer | Current balance in point system |
| `win_points` | Integer | Total points won |
| `created_at` | ISO 8601 | Account creation timestamp |
| `last_login` | ISO 8601 | Most recent login timestamp |

**Example Usage:**
```
GET {{baseUrl}}/players/me/
```
```
// Request Headers
{
  "initData": "user=%7B%22id%2..."
}
```

```
// Response (200 OK)
[
  {
    "telegram_id": 7432018050, // Example ID
    "first_name": "ðŸ˜ŽHongUpdated",
    "last_name": "LastName",
    "balance": 0,
    "win_points": 0,
    "photo_url": "https://t.me/i/userpic/320/....svg",
    "last_login": "2025-06-21T11:21:00+10:00"
  },
  // ... other players ...
]
```
---
**Update Current Player Details**

*   Authentication requires `initData` in **request headers**.
*   Update data (`put_data`) sent in the **request body**.
*   Allows partial updates.
*   Authentication handled via `@require_telegram_self` decorator.

**Endpoint:**
```
PUT {{baseUrl}}/players/me/
```

**Input Parameters (In Body):**
| Parameter | Type | Required | Description |
| --- | --- | --- | --- |
| `put_data` | JSON | Yes | Player attributes to update |

**`put_data` Allowed Fields:**
| Field | Type | Required | Description |
| --- | --- | --- | --- |
| `first_name` | string | No | Player's first name |
| `last_name` | string | No | Player's last name |
| `photo_url` | string | No | Profile photo URL |

**Response Status Codes:**
- `200 OK`: Player details updated successfully
- `404 BAD REQUEST`: put_data not valid
- `404 NOT FOUND`: Player not found

**Example Usage:**
```
// Request Body
{
  "put_data": {
    "first_name": "ðŸ˜ŽHongUpdated",
    "last_name": "LastName"
  }
}
```

```
// Response (200 OK)
{
    "user_pk_id": 2,
    "roles": [
        "player"
    ],
    "telegram_id": 7432018050,
    "first_name": "ðŸ˜ŽHongUpdated",
    "last_name": "LastName",
    "photo_url": "https://t.me/i/userpic/320/....svg",
    "balance": 0,
    "win_points": 0,
    "auth_key_hash": "",
    "created_at": "2025-04-16T13:54:36.302760+10:00",
    "last_login": "2025-06-21T11:21:00+10:00" // Example value
}
```

### âœ³ï¸ Influencer Profile API

**`POST` | Create Influencer Profile:** Create a new Influencer profile (only if not already an influencer)
**`GET`  | Get Influencer Profile:** Retrieve the current authenticated player's Influencer profile
**`PUT`  | Update Influencer Profile:** Update fields in the existing Influencer profile

**Create Influencer Profile**

*   Authentication requires `initData` in **request headers**.
*   Optional profile data (`facebook_id`, etc.) sent in the **request body**.
*   User must *not* already have the `influencer` role.
*   Authentication handled via `@require_telegram_self` decorator.

**Endpoint:**
```
POST {{baseUrl}}/influencers/me/
```

**Input Parameters:**
| Parameter | Location | Type | Required | Description |
| --- | --- | --- | --- | --- |
| `initData` | Headers | string | Yes | Telegram authentication data |
| `facebook_id` | Body | String | No | Facebook ID |
| `instagram_id` | Body | String | No | Instagram ID |
| `youtube_id` | Body | String | No | Youtube ID |
| `threads_id` | Body | String | No | Threads ID |

**Response Status Codes:**
- `200 OK`: Influencer profile saved
- `400 BAD REQUEST`: Influencer profile already exists, serializer.erros
- `404 NOT FOUND`: Player not found

**Response Body:**
| Field | Type | Description |
| --- | --- | --- |
| `message` | String | `Influencer profile saved` |
| `influencer_profile` | JSON | See below |

**Example Usage:**
```
// Request Body
{
  "initData": "user=%7B%22id%2..."
}
```
```
// Response (200 OK)
{
    "facebook_id": null,
    "instagram_id": null,
    "youtube_id": null,
    "threads_id": null,
    "influencer_since": "2025-06-21T11:22:00+10:00"
}
```
---
**Get Influencer Profile**

*   Authentication requires `initData` in **request headers**.
*   User must have the `influencer` role.
*   Authentication handled via `@require_telegram_self` decorator.

**Endpoint:**
```
GET {{baseUrl}}/influencers/me/
```

**Input Parameters:**
| Parameter  | Location | Type   | Required | Description                                                                                                                          |
|------------|----------|--------|----------|--------------------------------------------------------------------------------------------------------------------------------------|
| `initData` | Headers  | string | Yes      | URL-encoded authentication data from Telegram ([docs](https://core.telegram.org/bots/webapps#validating-data-received-via-the-mini-app)). Must be validated server-side. |

**Response Status Codes:**
- `200 OK`: Influencer profile retrieved successfully
- `404 NOT FOUND`: Influencer profile not found

**Response Body:**
| Field | Type | Description |
| --- | --- | --- |
| `influencer_profile` | JSON | See below |

**Example Usage:**
```
GET {{baseUrl}}/influencers/me/
```
```
// Request Headers
{
  "initData": "user=%7B%22id%2..."
}
```
```
// Response (200 OK)
{
    "facebook_id": null,
    "instagram_id": null,
    "youtube_id": null,
    "threads_id": null,
    "influencer_since": "2025-06-21T11:22:00+10:00"
}
```
---
**Update Influencer Profile**

*   Authentication requires `initData` in **request headers**.
*   Update data (`facebook_id`, etc.) sent in the **request body**.
*   Allows partial updates.
*   User must have the `influencer` role.
*   Authentication handled via `@require_telegram_self` decorator.

**Endpoint:**
```
PUT {{baseUrl}}/influencers/me/
```

**Input Parameters:**
| Parameter | Location | Type | Required | Description |
| --- | --- | --- | --- | --- |
| `initData` | Headers | string | Yes | Telegram authentication data |
| `facebook_id` | Body | String | Optional | Facebook ID |
| `instagram_id` | Body | String | Optional | Instagram ID |
| `youtube_id` | Body | String | Optional | Youtube ID |
| `threads_id` | Body | String | Optional | Threads ID |

**Response Status Codes:**
- `200 OK`: Influencer profile updated successfully
- `400 BAD REQUEST`: Invalid input parameters (serializer errors)
- `404 NOT FOUND`: Influencer profile not found

**Response Body:**
| Field | Type | Description |
| --- | --- | --- |
| `influencer_profile` | JSON | See below |

**Example Usage:**
```
// Request Body
{
  "facebook_id": "myFacebook",
  "instagram_id": "ig_test_id"
}
```
```
// Response (200 OK)
{
    "facebook_id": "myFacebook",
    "instagram_id": "ig_test_id",
    "youtube_id": null,
    "threads_id": null,
    "influencer_since": "2025-06-21T11:22:00+10:00"
}
```
---
### âœ³ï¸ Host Profile API

**`POST` | Create Host Profile:** Create a new Host profile (only if not already a host)
**`GET`  | Get Host Profile:** Retrieve the current authenticated player's Host profile
**`PUT`  | Update Host Profile:** Update fields in the existing Host profile

**Create Host Profile**

*   Authentication requires `initData` in **request headers**.
*   Profile data (`bio`) sent in the **request body**.
*   User must *not* already have the `host` role.
*   Authentication handled via `@require_telegram_self` decorator.

**Endpoint:**
```
POST {{baseUrl}}/hosts/me/
```

**Input Parameters:**
| Parameter | Location | Type | Required | Description |
| --- | --- | --- | --- | --- |
| `initData` | Headers | string | Yes | Telegram authentication data |
| `bio` | Body | String | Yes | Host bio (max 50 chars) |

**Response Status Codes:**
- `200 OK`: Host profile saved
- `400 BAD REQUEST`: Host profile already exists, serializer errors
- `404 NOT FOUND`: Player not found

**Response Body:**
| Field | Type | Description |
| --- | --- | --- |
| `bio` | String | Host's bio |
| `total_games_hosted` | Integer | Number of games hosted by this player |

**Example Usage:**
```
// Request Body
{
  "bio": "Experienced poker host."
}
```
```
// Response (200 OK)
{
    "bio": "Experienced poker host.",
    "total_games_hosted": 0
}
```

**Get Host Profile**

*   Authentication requires `initData` in **request headers**.
*   User must have the `host` role.
*   Authentication handled via `@require_telegram_self` decorator.

**Endpoint:**
```
GET {{baseUrl}}/hosts/me/
```

**Input Parameters:**
| Parameter  | Location | Type   | Required | Description|
|------------|----------|--------|----------|-------|
| `initData` | Headers  | string | Yes      | URL-encoded authentication data from Telegram ([docs](https://core.telegram.org/bots/webapps#validating-data-received-via-the-mini-app)). Must be validated server-side. |

**Response Status Codes:**
- `200 OK`: Host profile retrieved successfully
- `404 NOT FOUND`: Host profile not found

**Response Body:**
| Field | Type | Description |
| --- | --- | --- |
| `bio` | String | Host's bio |
| `total_games_hosted` | Integer | Number of games hosted by this player |

**Example Usage:**
```
GET {{baseUrl}}/hosts/me/
```
```
// Request Headers
{
  "initData": "user=%7B%22id%2..."
}
```
```
// Response (200 OK)
{
    "bio": "Experienced poker host.",
    "total_games_hosted": 0
}
```

**Update Host Profile**

*   Authentication requires `initData` in **request headers**.
*   Update data (`bio`) sent in the **request body**.
*   Allows partial updates.
*   User must have the `host` role.
*   Authentication handled via `@require_telegram_self` decorator.

**Endpoint:**
```
PUT {{baseUrl}}/hosts/me/
```

**Input Parameters:**
| Parameter | Location | Type | Required | Description |
| --- | --- | --- | --- | --- |
| `initData` | Headers | string | Yes | Telegram authentication data |
| `bio` | Body | String | Optional | New bio for the host (max 50 chars) |

**Response Status Codes:**
- `200 OK`: Host profile updated successfully
- `400 BAD REQUEST`: Invalid input parameters (serializer errors)
- `404 NOT FOUND`: Host profile not found

**Response Body:**
| Field | Type | Description |
| --- | --- | --- |
| `bio` | String | Updated host's bio |
| `total_games_hosted` | Integer | Number of games hosted by this player |

**Example Usage:**
```
// Request Body
{
  "bio": "Updated bio - Host of Friday night games!"
}
```
```
// Response (200 OK)
{
    "bio": "Updated bio - Host of Friday night games!",
    "total_games_hosted": 0
}
```

## ðŸ“Œ Game & Session Management API

### âœ³ï¸ Host Game API

**`POST` | Create Game:** Create a new game
**`GET` | List Host's Games:** List all games hosted by the user
**`GET` | Get Specific Host Game:** Get details of a specific game hosted by the user
**`PUT` | Update Game:** Update details of a specific game hosted by the user

**Create Game**

*   Authentication requires `initData` in **request headers**.
*   Game data sent in the **request body**.
*   Requires **Host** role.
*   Authentication handled via `@require_telegram_self` and `@require_host` decorators.

**Endpoint:**
```
POST {{baseUrl}}/host/game/
```

**Input Parameters:**
| Parameter        | Location | Type                 | Required | Description                                                                                                                          |
|------------------|----------|----------------------|----------|--------------------------------------------------------------------------------------------------------------------------------------|
| `initData`       | Headers  | string               | Yes      | URL-encoded authentication data from Telegram ([docs](https://core.telegram.org/bots/webapps#validating-data-received-via-the-mini-app)). Must be validated server-side. |
| `title`          | Body     | string               | Yes      | Name of the poker game (max 255 chars)                                                                                               |
| `recurrence`     | Body     | string               | Yes      | Game frequency ("once", "daily", "weekly", "fortnightly", "monthly")                                                                 |
| `days_of_week`   | Body     | list[integer]        | No       | Days for recurrence (0=Mon, 6=Sun). Required if recurrence is not "once" or "daily".                                                 |
| `start_datetime` | Body     | string (ISO 8601)    | Yes      | Date and time when the game starts (e.g., "2025-06-30T19:30:00+10:00")                                                              |
| `location`       | Body     | string               | No       | Physical location of the game (max 255 chars)                                                                                        |
| `duration`       | Body     | string (e.g., "8:00:00") | No       | Expected duration (default: 8 hours)                                                                                               |
| `notes`          | Body     | string               | No       | Optional remarks from the host                                                                                                       |
| `required_deposit`| Body    | integer              | No       | Minimum deposit required                                                                                                             |
| `small_blind`    | Body     | integer              | Yes      | Small blind amount                                                                                                                   |
| `big_blind`      | Body     | integer              | Yes      | Big blind amount                                                                                                                     |
| `straddle`       | Body     | integer              | No       | Optional straddle amount                                                                                                             |
| `min_buy_in`     | Body     | integer              | Yes      | Minimum buy-in amount                                                                                                                |
| `max_buy_in`     | Body     | integer              | Yes      | Maximum buy-in amount                                                                                                                |
| `max_players`    | Body     | integer              | Yes      | Maximum number of players allowed                                                                                                    |

**Response Status Codes:**
- `201 Created`: Game created successfully
- `400 Bad Request`: Invalid input parameters
- `401 Unauthorized`: Authentication failed
- `403 Forbidden`: User is not a Host
- `404 Not Found`: Player not found

**Response Body:**
Full `Game` object (see `models.py` or GET endpoint response).

> ðŸ’¡ **Note:** Creates the `Game` and the first `GameSession` based on the `start_datetime` and `recurrence`.

**Example Usage:**
```
POST {{baseUrl}}/host/game/
```
```
// Request Headers
| Header     | Value |
|------------|---|
| `initData` | `user=%7B%22id%2...` |
```
```
// Request Body
{
  "title": "Weekly Poker Night",
  "recurrence": "weekly",
  "days_of_week": [4], // Friday
  "start_datetime": "2025-07-04T19:00:00+10:00",
  "location": "Host's Place",
  "duration": "04:00:00",
  "small_blind": 5,
  "big_blind": 10,
  "min_buy_in": 100,
  "max_buy_in": 500,
  "max_players": 9
}
```
```
// Response (201 Created)
{
  "id": 4, // Example value
  "host": 2, // HostProfile PK ID for user 7432018050
  "title": "Weekly Poker Night",
  "recurrence": "weekly",
  "days_of_week": [4],
  "start_datetime": "2025-07-04T19:00:00+10:00",
  "location": "Host's Place",
  "duration": "04:00:00",
  "notes": null,
  "required_deposit": null,
            "small_blind": 5,
            "big_blind": 10,
  "straddle": null,
  "min_buy_in": 100,
  "max_buy_in": 500,
  "max_players": 9,
  "created_at": "2025-06-21T11:23:00+10:00" // Example value
}
```
---

**List Host's Games**

+*   Authentication requires `initData` in **request headers**.
+*   Requires **Host** role.
+*   Authentication handled via `@require_telegram_self` and `@require_host` decorators.
+
 **Endpoint:**
 ```
 GET {{baseUrl}}/host/game/
```

**Input Parameters:**
| Parameter  | Location | Type   | Required | Description                                                                                                                          |
|------------|----------|--------|----------|--------------------------------------------------------------------------------------------------------------------------------------|
| `initData` | Headers  | string | Yes      | URL-encoded authentication data from Telegram ([docs](https://core.telegram.org/bots/webapps#validating-data-received-via-the-mini-app)). Must be validated server-side. |

**Response Status Codes:**
- `200 OK`: Games listed successfully
- `401 Unauthorized`: Authentication failed
- `403 Forbidden`: User is not a Host
- `404 Not Found`: Player not found

**Response Body:**
Array of `Game` objects hosted by the player.

**Example Usage:**
```
GET {{baseUrl}}/host/game/
```
```
// Request Headers
| Header     | Value                                     |
|------------|-------------------------------------------|
| `initData` | `user=%7B%22id%2...` |
```
```
// Request Body
N/A
```
```
// Response (200 OK)
[
  {
    "id": 4, // Example game created above
    "host": 2,
    "title": "Weekly Poker Night",
    "recurrence": "weekly",
    "days_of_week": [4],
    "start_datetime": "2025-07-04T19:00:00+10:00",
    "location": "Host's Place",
    "duration": "04:00:00",
    "notes": null,
    "required_deposit": null,
    "small_blind": 5,
    "big_blind": 10,
    "straddle": null,
    "min_buy_in": 100,
    "max_buy_in": 500,
    "max_players": 9,
    "created_at": "2025-06-21T11:23:00+10:00"
  },
  // ... other games hosted by this user ...
]
```
---

**Get Specific Host Game**

**Endpoint:**
```
GET {{baseUrl}}/host/game/{game_id}/
```
Authentication requires `initData` in **request headers**. Path parameter `game_id`.
Requires **Host** role.

**Input Parameters:**
| Parameter  | Location | Type    | Required | Description                                                                                                                          |
|------------|----------|---------|----------|--------------------------------------------------------------------------------------------------------------------------------------|
| `initData` | Headers  | string  | Yes      | URL-encoded authentication data from Telegram ([docs](https://core.telegram.org/bots/webapps#validating-data-received-via-the-mini-app)). Must be validated server-side. |
| `game_id`  | Path     | integer | Yes      | ID of the game to retrieve.                                                                                                          |

**Response Status Codes:**
- `200 OK`: Game details retrieved
- `401 Unauthorized`: Authentication failed
- `403 Forbidden`: User is not the host of this game
- `404 Not Found`: Player or Game not found

**Response Body:**
Full `Game` object.

**Example Usage:**
```
GET {{baseUrl}}/host/game/4/
```
```
// Request Headers
| Header     | Value                                     |
|------------|-------------------------------------------|
| `initData` | `user=%7B%22id%2...` |
```
```
// Request Body
N/A
```
```
// Response (200 OK)
{
  "id": 4,
  "host": 2,
  "title": "Weekly Poker Night",
  "recurrence": "weekly",
  "days_of_week": [4],
  "start_datetime": "2025-07-04T19:00:00+10:00",
  "location": "Host's Place",
  "duration": "04:00:00",
  "notes": null,
  "required_deposit": null,
  "small_blind": 5,
  "big_blind": 10,
  "straddle": null,
  "min_buy_in": 100,
  "max_buy_in": 500,
  "max_players": 9,
  "created_at": "2025-06-21T11:23:00+10:00"
}
```
---

**Update Game**

**Endpoint:**
```
PUT {{baseUrl}}/host/game/{game_id}/
```
Authentication requires `initData` in **request headers**. Path parameter `game_id`. Update data sent in the **request body**.
Requires **Host** role. Allows partial updates.

**Input Parameters:**
| Parameter        | Location | Type                 | Required | Description                                                                                                                          |
|------------------|----------|----------------------|----------|--------------------------------------------------------------------------------------------------------------------------------------|
| `initData`       | Headers  | string               | Yes      | URL-encoded authentication data from Telegram ([docs](https://core.telegram.org/bots/webapps#validating-data-received-via-the-mini-app)). Must be validated server-side. |
| `game_id`        | Path     | integer              | Yes      | ID of the game to update.                                                                                                            |
| `title`          | Body     | string               | No       | New name of the poker game (max 255 chars)                                                                                           |
| `recurrence`     | Body     | string               | No       | New game frequency ("once", "daily", "weekly", "fortnightly", "monthly")                                                             |
| `days_of_week`   | Body     | list[integer]        | No       | New days for recurrence (0=Mon, 6=Sun).                                                                                              |
| `start_datetime` | Body     | string (ISO 8601)    | No       | New date and time when the game starts.                                                                                              |
| `location`       | Body     | string               | No       | New physical location of the game (max 255 chars)                                                                                    |
| `duration`       | Body     | string (e.g., "8:00:00") | No       | New expected duration.                                                                                                             |
| `notes`          | Body     | string               | No       | New optional remarks from the host.                                                                                                  |
| `required_deposit`| Body    | integer              | No       | New minimum deposit required.                                                                                                        |
| `small_blind`    | Body     | integer              | No       | New small blind amount.                                                                                                              |
| `big_blind`      | Body     | integer              | No       | New big blind amount.                                                                                                                |
| `straddle`       | Body     | integer              | No       | New optional straddle amount.                                                                                                        |
| `min_buy_in`     | Body     | integer              | No       | New minimum buy-in amount.                                                                                                           |
| `max_buy_in`     | Body     | integer              | No       | New maximum buy-in amount.                                                                                                           |
| `max_players`    | Body     | integer              | No       | New maximum number of players allowed.                                                                                               |

**Response Status Codes:**
- `200 OK`: Game updated successfully
- `400 Bad Request`: Invalid input data
- `401 Unauthorized`: Authentication failed
- `403 Forbidden`: User is not the host of this game
- `404 Not Found`: Player or Game not found

**Response Body:**
Updated full `Game` object.

**Example Usage (Partial Update):**
```
PUT {{baseUrl}}/host/game/4/
```
```
// Request Headers
| Header     | Value                                     |
|------------|-------------------------------------------|
| `initData` | `user=%7B%22id%2...` |
```
```
// Request Body
{
  "title": "Updated Weekly Poker Night",
  "location": "New Location"
}
```
```
// Response (200 OK)
{
  "id": 4,
  "host": 2,
  "title": "Updated Weekly Poker Night",
  "recurrence": "weekly",
  "days_of_week": [4],
  "start_datetime": "2025-07-04T19:00:00+10:00",
  "location": "New Location",
  "duration": "04:00:00",
  "notes": null,
  "required_deposit": null,
    "small_blind": 5,
    "big_blind": 10,
  "straddle": null,
  "min_buy_in": 100,
  "max_buy_in": 500,
  "max_players": 9,
  "created_at": "2025-06-21T11:23:00+10:00"
}
```

### âœ³ï¸ Player Game API

**`GET` | List Games:** List all available games (simplified view)
**`GET` | Get Specific Game Details:** Get details of a specific game (simplified view)

**List Games**

**Endpoint:**
```
GET {{baseUrl}}/game/
```
Authentication requires `initData` in **request headers**.

**Input Parameters:**
| Parameter  | Location | Type   | Required | Description                                                                                                                          |
|------------|----------|--------|----------|--------------------------------------------------------------------------------------------------------------------------------------|
| `initData` | Headers  | string | Yes      | URL-encoded authentication data from Telegram ([docs](https://core.telegram.org/bots/webapps#validating-data-received-via-the-mini-app)). Must be validated server-side. |

**Response Body:**
Array of `Game` objects (simplified view using `PlayerGameSerializer`). Excludes `created_at` and `host`.

**Example Usage:**
```
GET {{baseUrl}}/game/
```
```
// Request Headers
| Header     | Value                                     |
|------------|-------------------------------------------|
| `initData` | `user=%7B%22id%2...` |
```
```
// Request Body
N/A
```
```
// Response (200 OK)
[
  {
    "id": 4, // Example game ID
    "title": "Updated Weekly Poker Night", // Reflects previous PUT update
    "recurrence": "weekly",
    "days_of_week": [4],
    "start_datetime": "2025-07-04T19:00:00+10:00",
    "location": "New Location", // Reflects previous PUT update
    "duration": "04:00:00",
    "notes": null,
    "required_deposit": null,
    "small_blind": 5,
    "big_blind": 10,
    "straddle": null,
    "min_buy_in": 100,
    "max_buy_in": 500,
    "max_players": 9
  },
  // ... more games ...
]
```
---

**Get Specific Game Details**

**Endpoint:**
```
GET {{baseUrl}}/game/{game_id}/
```
Authentication requires `initData` in **request headers**. Path parameter `game_id`.

**Input Parameters:**
| Parameter  | Location | Type    | Required | Description                                                                                                                          |
|------------|----------|---------|----------|--------------------------------------------------------------------------------------------------------------------------------------|
| `initData` | Headers  | string  | Yes      | URL-encoded authentication data from Telegram ([docs](https://core.telegram.org/bots/webapps#validating-data-received-via-the-mini-app)). Must be validated server-side. |
| `game_id`  | Path     | integer | Yes      | ID of the game to retrieve.                                                                                                          |

**Response Status Codes:**
- `200 OK`: Game details retrieved
- `401 Unauthorized`: Authentication failed
- `404 Not Found`: Player or Game not found

**Response Body:**
Simplified `Game` object (using `PlayerGameSerializer`).

**Example Usage:**
```
GET {{baseUrl}}/game/1/
```
```
// Request Headers
| Header     | Value                                     |
|------------|-------------------------------------------|
| `initData` | `user=%7B%22id%2...` |
```
```
// Request Body
N/A
```
```
// Response (200 OK)
{
  "id": 1,
  "title": "Updated Weekly Poker Night",
  "recurrence": "weekly",
  "days_of_week": [4],
  "start_datetime": "2025-07-04T19:00:00+10:00",
  "location": "New Location",
  "duration": "04:00:00",
  "notes": null,
  "required_deposit": null,
  "small_blind": 5,
  "big_blind": 10,
  "straddle": null,
  "min_buy_in": 100,
  "max_buy_in": 500,
  "max_players": 9
}
```

### âœ³ï¸ Host Session API

**`GET` | List Sessions:** List sessions hosted by the user
**`GET` | Get Specific Host Session:** Get details of a specific session hosted by the user
**`PUT` | Update Session:** Update details of a specific session hosted by the user

**List Sessions**

* Requires **Host** role.
* Authentication requires `initData` in **request headers**.

**Endpoint:**
```
GET {{baseUrl}}/host/session/
```

**Input Parameters:**
| Parameter  | Location | Type   | Required | Description                                                                                                                          |
|------------|----------|--------|----------|--------------------------------------------------------------------------------------------------------------------------------------|
| `initData` | Headers  | string | Yes      | URL-encoded authentication data from Telegram ([docs](https://core.telegram.org/bots/webapps#validating-data-received-via-the-mini-app)). Must be validated server-side. |

**Response Status Codes:**
- `200 OK`: Sessions listed successfully
- `401 Unauthorized`: Authentication failed
- `403 Forbidden`: User is not a Host
- `404 Not Found`: Player or no sessions found

**Response Body:**
Array of `GameSession` objects hosted by the player, ordered by descending `start_datetime`. Includes `game_title`.

**Example Usage:**
```
GET {{baseUrl}}/host/session/
```
```
// Request Headers
| Header     | Value                                     |
|------------|-------------------------------------------|
| `initData` | `user=%7B%22id%2...` |
```
```
// Request Body
N/A
```
```
// Response (200 OK)
[
  {
    "id": 2,
    "game": 4,
    "start_datetime": "2025-07-04T19:00:00+10:00",
    "end_datetime": null,
    "is_cancelled": true,
    "is_completed": false,
    "small_blind": 5,
    "big_blind": 10,
    "straddle": null,
    "min_buy_in": 100,
    "max_buy_in": 500,
    "max_players": 9
  },
  // ... other sessions hosted by this user ...
]
```
---

**Get Specific Host Session**

Path parameter `session_id`.
Requires **Host** role.
Authentication requires `initData` in **request headers**. 
Authentication handled via `@require_telegram_self` and `@require_host` decorators.


**Endpoint:**
```
GET {{baseUrl}}/host/session/{session_id}/
```

**Input Parameters:**
| Parameter    | Location | Type    | Required | Description                                                                                                                          |
|--------------|----------|---------|----------|--------------------------------------------------------------------------------------------------------------------------------------|
| `initData`   | Headers  | string  | Yes      | URL-encoded authentication data from Telegram ([docs](https://core.telegram.org/bots/webapps#validating-data-received-via-the-mini-app)). Must be validated server-side. |
| `session_id` | Path     | integer | Yes      | ID of the session to retrieve.                                                                                                       |

**Response Status Codes:**
- `200 OK`: Session details retrieved
- `401 Unauthorized`: Authentication failed
- `403 Forbidden`: User is not the host of the game for this session
- `404 Not Found`: Player or Session not found

**Response Body:**
Full `GameSession` object, including `game_title`.

**Example Usage:**
```
GET {{baseUrl}}/host/session/1/
```
```
// Request Headers
| Header     | Value                                     |
|------------|-------------------------------------------|
| `initData` | `user=%7B%22id%2...` |
```
```
// Request Body
N/A
```
```
// Response (200 OK)
{
  "id": 2,
  "game": 4,
  "game_title": "Updated Weekly Poker Night",
  "start_datetime": "2025-07-04T19:00:00+10:00",
  "end_datetime": null,
  "is_cancelled": true,
  "is_completed": false,
  "num_players_checked_in": 0,
  "created_at": "2025-06-21T11:23:00+10:00",
  "small_blind": 5,
  "big_blind": 10,
  "straddle": null,
  "min_buy_in": 100,
  "max_buy_in": 500,
  "max_players": 9
}
```
---

**Update Session**

* Path parameter `session_id`. 
* Update data in **request body**.
* Allows partial updates.
* Authentication requires `initData` in **request headers**. 
* Requires **Host** role. 

**Endpoint:**
```
PUT {{baseUrl}}/host/session/{session_id}/
```


**Input Parameters:**
| Parameter              | Location | Type              | Required | Description                                                                                                                          |
|------------------------|----------|-------------------|----------|--------------------------------------------------------------------------------------------------------------------------------------|
| `initData`             | Headers  | string            | Yes      | URL-encoded authentication data from Telegram ([docs](https://core.telegram.org/bots/webapps#validating-data-received-via-the-mini-app)). Must be validated server-side. |
| `session_id`           | Path     | integer           | Yes      | ID of the session to update.                                                                                                         |
| `start_datetime`       | Body     | string (ISO 8601) | No       | New start date/time.                                                                                                                 |
| `end_datetime`         | Body     | string (ISO 8601) | No       | New end date/time.                                                                                                                   |
| `is_cancelled`         | Body     | boolean           | No       | Mark session as cancelled.                                                                                                           |
| `is_completed`         | Body     | boolean           | No       | Mark session as completed.                                                                                                           |
| `small_blind`          | Body     | integer           | No       | Override game's small blind for this session.                                                                                        |
| `big_blind`            | Body     | integer           | No       | Override game's big blind for this session.                                                                                          |
| `straddle`             | Body     | integer           | No       | Override game's straddle for this session.                                                                                           |
| `min_buy_in`           | Body     | integer           | No       | Override game's min buy-in for this session.                                                                                         |
| `max_buy_in`           | Body     | integer           | No       | Override game's max buy-in for this session.                                                                                         |
| `max_players`          | Body     | integer           | No       | Override game's max players for this session.                                                                                        |

**Response Status Codes:**
- `200 OK`: Session updated successfully
- `400 Bad Request`: Invalid input data
- `401 Unauthorized`: Authentication failed
- `403 Forbidden`: User is not the host of the game for this session
- `404 Not Found`: Player or Session not found

**Response Body:**
Updated full `GameSession` object.

**Example Usage (Mark as Cancelled):**
```
PUT {{baseUrl}}/host/session/1/
```
```
// Request Headers
| Header     | Value                                     |
|------------|-------------------------------------------|
| `initData` | `user=%7B%22id%2...` |
```
```
// Request Body
{
  "is_cancelled": true
}
```
```
// Response (200 OK)
{
  "id": 2,
  "game": 4,
  "game_title": "Updated Weekly Poker Night",
  "start_datetime": "2025-07-04T19:00:00+10:00",
  "end_datetime": null,
  "is_cancelled": true,
  "is_completed": false,
  "num_players_checked_in": 0,
  "created_at": "2025-06-21T11:23:00+10:00",
    "small_blind": 5,
    "big_blind": 10,
  "straddle": null,
  "min_buy_in": 100,
  "max_buy_in": 500,
  "max_players": 9
}
```

### âœ³ï¸ Player Session API

**`GET` | List Sessions:** List all available sessions (simplified view)
**`GET` | List Sessions for a Specific Game:** List sessions for a specific game (simplified view)
**`GET` | Get Specific Session Details:** Get details of a specific session (simplified view)

**List Sessions**

* Authentication requires `initData` in **request headers**.

**Endpoint:**
```
GET {{baseUrl}}/session/
```

**Input Parameters:**
| Parameter  | Location | Type   | Required | Description                                                                                                                          |
|------------|----------|--------|----------|--------------------------------------------------------------------------------------------------------------------------------------|
| `initData` | Headers  | string | Yes      | URL-encoded authentication data from Telegram ([docs](https://core.telegram.org/bots/webapps#validating-data-received-via-the-mini-app)). Must be validated server-side. |

**Response Status Codes:**
- `200 OK`: Sessions listed successfully
- `401 Unauthorized`: Authentication failed
- `404 Not Found`: Player not found

**Response Body:**
Array of all `GameSession` objects (simplified view using `PlayerGameSessionSerializer`), ordered by descending `start_datetime`. Excludes `num_players_checked_in` and `created_at`.

**Example Usage:**
```
GET {{baseUrl}}/session/
```
```
// Request Headers
| Header     | Value                                     |
|------------|-------------------------------------------|
| `initData` | `user=%7B%22id%2...` |
```

**List All Sessions**

* Lists all game sessions.
* Authentication requires `initData` in **request headers**.

**Endpoint:**
```
GET {{baseUrl}}/session/
```

**Input Parameters:**
| Parameter | Location | Type | Required | Description |
| --- | --- | --- | --- | --- |
| `initData` | Headers | string | Yes | Telegram authentication data |

**Response Status Codes:**
- `200 OK`: Sessions listed successfully
- `401 Unauthorized`: Authentication failed

**Response Body:**
Array of GameSession objects ordered by descending start date.

**Example Usage:**
```
GET {{baseUrl}}/session/
```
```
// Request Headers
| Header | Value |
| --- | --- |
| `initData` | `user=%7B%22id%2...` |
```
```
// Response (200 OK)
[
  {
    "id": 1,
    "game": 1,
    "start_datetime": "2025-07-04T19:00:00+10:00",
    "end_datetime": null,
    "is_cancelled": true,
    "is_completed": false,
    "small_blind": 5,
    "big_blind": 10,
    "straddle": null,
    "min_buy_in": 100,
    "max_buy_in": 500,
    "max_players": 9
  },
  // ... more sessions ...
]
```

**List Sessions for a Specific Game**

* Query parameter `game_id`.
* Authentication requires `initData` in **request headers**. 

**Endpoint:**
```
GET {{baseUrl}}/session/?game_id={game_id}
```

**Input Parameters:**
| Parameter | Location | Type | Required | Description |
| --- | --- | --- | --- | --- |
| `initData` | Headers | string | Yes | Telegram authentication data |
| `game_id` | Query | integer | Yes | ID of the game to list sessions for |

**Response Status Codes:**
- `200 OK`: Sessions listed successfully
- `401 Unauthorized`: Authentication failed
- `404 Not Found`: Player or Game not found, or no sessions found

**Example Usage:**
```
GET {{baseUrl}}/session/?game_id=1
```
```
// Request Headers
| Header | Value |
| --- | --- |
| `initData` | `user=%7B%22id%2...` |
```
```
// Response (200 OK)
[
  {
    "id": 2,
    "game": 4,
    "start_datetime": "2025-07-04T19:00:00+10:00",
    "end_datetime": null,
    "is_cancelled": true,
    "is_completed": false,
    "small_blind": 5,
    "big_blind": 10,
    "straddle": null,
    "min_buy_in": 100,
    "max_buy_in": 500,
    "max_players": 9
  }
  // ... other sessions for game 4 ...
]
```

**Get Specific Session Details**

* Authentication requires `initData` in **request headers**.
* Path parameter `session_id` specifies the session.

**Endpoint:**
```
GET {{baseUrl}}/session/{session_id}/
```

**Input Parameters:**
| Parameter | Location | Type | Required | Description |
| --- | --- | --- | --- | --- |
| `initData` | Headers | string | Yes | Telegram authentication data |
| `session_id` | Path | integer | Yes | ID of the session to retrieve |

**Response Status Codes:**
- `200 OK`: Session details retrieved
- `401 Unauthorized`: Authentication failed
- `404 Not Found`: Player or Session not found

**Example Usage:**
```
GET {{baseUrl}}/session/1/
```
```
// Request Headers
| Header | Value |
| --- | --- |
| `initData` | `user=%7B%22id%2...` |
```
```
// Response (200 OK)
{
  "id": 1,
  "game": 4,
  "start_datetime": "2025-07-04T19:00:00+10:00",
  "end_datetime": null,
  "is_cancelled": true,
  "is_completed": false,
  "small_blind": 5,
  "big_blind": 10,
  "straddle": null,
  "min_buy_in": 100,
  "max_buy_in": 500,
  "max_players": 9
}
```

## ðŸ“Œ Scheduler APIs

### â›” generate_session/
> In progress

## ðŸ“Œ Planned APIs

### â›” games/join/
> In progress

### â›” games/<int:game_id>/
> In progress

### â›” players/
> In progress

### â›” players/hosting/
> In progress

### â›” players/joined/
> In progress